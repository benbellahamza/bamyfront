<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-100 to-slate-300">
  <div class="w-full max-w-4xl bg-white p-10 rounded-2xl shadow-2xl animate-fade-in space-y-8">
    
    <!-- Horloge et compteur -->
    <div class="flex justify-between items-center">
      <div class="text-lg font-mono font-bold text-blue-700">{{ currentTime }}</div>
      <div class="badge badge-info text-sm font-semibold shadow">
        Visiteurs aujourd'hui : {{ compteur }}
      </div>
    </div>

    <!-- Message de confirmation -->
    <div *ngIf="confirmationMessage" class="alert alert-success shadow text-sm">
      ✅ {{ confirmationMessage }}
    </div>

    <!-- Formulaire principal -->
    <form [formGroup]="visiteurForm" (ngSubmit)="onSubmit()" class="grid grid-cols-1 md:grid-cols-2 gap-6">
      
      <!-- Nom -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Nom *</label>
        <input type="text" formControlName="nom" placeholder="Nom"
               class="input input-bordered w-full focus:ring-2 focus:ring-blue-500 text-black" />
        <small *ngIf="visiteurForm.get('nom')?.invalid && visiteurForm.get('nom')?.touched"
               class="text-red-500 text-xs">Champ requis</small>
      </div>

      <!-- Prénom -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Prénom *</label>
        <input type="text" formControlName="prenom" placeholder="Prénom"
               class="input input-bordered w-full focus:ring-2 focus:ring-blue-500 text-black" />
        <small *ngIf="visiteurForm.get('prenom')?.invalid && visiteurForm.get('prenom')?.touched"
               class="text-red-500 text-xs">Champ requis</small>
      </div>

      <!-- CIN -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">CIN *</label>
        <input type="text" formControlName="cin" placeholder="CIN"
               class="input input-bordered w-full focus:ring-2 focus:ring-blue-500 text-black" />
        <small *ngIf="visiteurForm.get('cin')?.invalid && visiteurForm.get('cin')?.touched"
               class="text-red-500 text-xs">Minimum 5 caractères requis</small>
      </div>

      <!-- Téléphone -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Téléphone *</label>
        <input type="text" formControlName="telephone" placeholder="Téléphone"
               class="input input-bordered w-full focus:ring-2 focus:ring-blue-500 text-black" />
      </div>

      <!-- Genre -->
      <div class="md:col-span-2">
        <label class="block text-sm font-semibold text-slate-700 mb-2">Genre *</label>
        <div class="flex justify-center gap-6">
          <button type="button"
                  (click)="visiteurForm.get('genre')?.setValue('Homme')"
                  [ngClass]="{
                    'btn btn-outline btn-primary': visiteurForm.get('genre')?.value !== 'Homme',
                    'btn btn-primary': visiteurForm.get('genre')?.value === 'Homme'
                  }">
            Homme
          </button>
          <button type="button"
                  (click)="visiteurForm.get('genre')?.setValue('Femme')"
                  [ngClass]="{
                    'btn btn-outline btn-primary': visiteurForm.get('genre')?.value !== 'Femme',
                    'btn btn-primary': visiteurForm.get('genre')?.value === 'Femme'
                  }">
            Femme
          </button>
        </div>
      </div>

      <!-- Destination -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Destination *</label>
        <select formControlName="destination" class="select select-bordered w-full text-black focus:ring-2 focus:ring-blue-500">
          <option value="">Sélectionnez une destination</option>
          <option value="atelier">Atelier</option>
          <option value="administration">Administration</option>
          <option value="réception">Réception</option>
          <option value="comptoir">Comptoir</option>
        </select>
      </div>

      <!-- Type de visiteur -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Type de visiteur</label>
        <select formControlName="typeVisiteur" class="select select-bordered w-full text-black focus:ring-2 focus:ring-blue-500">
          <option value="">-- Facultatif --</option>
          <option value="Particulier">Particulier</option>
          <option value="Entreprise">Entreprise</option>
        </select>
      </div>

      <!-- Matricule (si destination = atelier) -->
      <div *ngIf="visiteurForm.get('destination')?.value === 'atelier'" class="md:col-span-2">
        <label class="block text-sm font-semibold text-slate-700 mb-1">Matricule *</label>
        <input type="text" formControlName="matricule" placeholder="Numéro de matricule"
               class="input input-bordered w-full focus:ring-2 focus:ring-blue-500 text-black" />
      </div>

      <!-- Bouton de soumission -->
      <div class="md:col-span-2 flex justify-center mt-4">
        <button type="submit" class="btn btn-primary w-1/2"
                [disabled]="loading || visiteurForm.invalid">
          <span *ngIf="loading" class="loading loading-spinner mr-2"></span>
          {{ selectedVisiteurId ? 'Modifier' : 'Confirmer' }}
        </button>
      </div>
    </form>
  </div>
</div>
